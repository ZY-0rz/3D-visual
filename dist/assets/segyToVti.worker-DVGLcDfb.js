(function(){let e=new TextEncoder,t=t=>e.encode(t),n=e=>{let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e>>>0,!0),t},r=(e,t,n)=>Math.max(t,Math.min(n,e));self.onmessage=e=>{let{buffer:i,dims:a,origin:o,spacing:s,scalarName:c}=e.data||{},l=new Float32Array(i),u=Number(a?.[0]??0),d=Number(a?.[1]??0),f=Number(a?.[2]??0);if(!u||!d||!f){self.postMessage({error:`Invalid dimensions.`});return}let p=u*d*f;if(l.length!==p){self.postMessage({error:`Invalid volume length. expected=${p} got=${l.length}`});return}let m=Number(o?.[0]??0),h=Number(o?.[1]??0),g=Number(o?.[2]??0),_=Math.max(1e-12,Number(s?.[0]??1)),v=Math.max(1e-12,Number(s?.[1]??1)),y=Math.max(1e-12,Number(s?.[2]??1)),b=String(c||`Seismic`),x=t(`<?xml version="1.0"?>
<VTKFile type="ImageData" version="0.1" byte_order="LittleEndian" header_type="UInt32">
  <ImageData WholeExtent="0 ${u-1} 0 ${d-1} 0 ${f-1}" Origin="${m} ${h} ${g}" Spacing="${_} ${v} ${y}">\n    <Piece Extent="0 ${u-1} 0 ${d-1} 0 ${f-1}">\n      <PointData Scalars="${b}">\n        <DataArray type="Float32" Name="${b}" format="appended" offset="0"/>\n      </PointData>\n      <CellData></CellData>\n    </Piece>\n  </ImageData>\n  <AppendedData encoding="raw">\n_`),S=t(`
  </AppendedData>
</VTKFile>
`),C=p*4,w=x.length+4+C+S.length,T=new Uint8Array(w);T.set(x,0),T.set(n(C),x.length);let E=x.length+4,D=new DataView(T.buffer,E,C),O=u*d,k=Math.max(1,Math.floor(d/40));for(let e=0;e<d;e++){let t=e*u*f;for(let n=0;n<u;n++){let r=t+n*f;for(let t=0;t<f;t++){let i=l[r+t],a=n+e*u+t*O;D.setFloat32(a*4,i,!0)}}e%k===0&&self.postMessage({progress:r(e/d,0,1)})}T.set(S,E+C),self.postMessage({buffer:T.buffer,progress:1},[T.buffer])}})();